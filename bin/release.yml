steps:
  - block: "Request Release"
    fields:
      - text: "Version"
        key: "release-version"
        hint: "Version for this release using semver (v.<major-version-number>.<minor-version-number>.<patch-number>) :writing_hand:"
        required: true
      - text: "CHANGELOG"
        key: "release-changelog"
        hint: "What has changed with this release?"
        required: true
  - label: ':rocket:'
    commands: 
      - RELEASE_VERSION=buildkite-agent meta-data get "release-version"
      - RELEASE_CHANGELOG=buildkite-agent meta-data get "release-changelog"
      - env
      - git tag -a "${BUILDKITE_AGENT_META_DATA_RELEASE_VERSION}" -m "CHANGELOG. ${BUILDKITE_AGENT_META_DATA_RELEASE_CHANGELOG}"
      - git push origin "${BUILDKITE_AGENT_META_DATA_RELEASE_VERSION}"
      - echo "Created release ${BUILDKITE_AGENT_META_DATA_RELEASE_VERSION}"
  